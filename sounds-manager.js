/* ==================================================
   ğŸµ Ù…Ø¯ÙŠØ± Ø§Ù„ØµÙˆØªÙŠØ§Øª Ø§Ù„Ù…ÙˆØ­Ø¯ (Sounds Manager) - Local Files
   ================================================== */

(function() {
    // 1. Ø®Ø±ÙŠØ·Ø© Ø§Ù„Ø£ØµÙˆØ§Øª (ØªØ£ÙƒØ¯ Ø£Ù† Ø§Ù„Ø§Ù…ØªØ¯Ø§Ø¯Ø§Øª mp3 Ø£Ùˆ wav ØµØ­ÙŠØ­Ø© ÙƒÙ…Ø§ ÙÙŠ Ù…Ø¬Ù„Ø¯Ùƒ)
    const soundMap = {
        // Ø±Ø³Ø§Ù„Ø© ÙˆØ§Ø±Ø¯Ø© (Ù…Ù† Ø§Ù„ØµÙˆØ±Ø© Ø¹Ù†Ø¯Ùƒ)
        'incoming': './sounds/incoming.mp3', 
        
        // Ø±Ù†Ø© Ø§ØªØµØ§Ù„ ÙˆØ§Ø±Ø¯ (Ù…Ù† Ø§Ù„ØµÙˆØ±Ø©)
        'ring_in':  './sounds/ring_in.wav',   
        
        // Ø±Ù†Ø© Ø§ØªØµØ§Ù„ ØµØ§Ø¯Ø± (Ù…Ù† Ø§Ù„ØµÙˆØ±Ø©)
        'ring_out': './sounds/ring_out.mp3',  
        
        // Ø¥Ù†Ù‡Ø§Ø¡ Ø§Ù„Ù…ÙƒØ§Ù„Ù…Ø© (ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø§Ù…ØªØ¯Ø§Ø¯ØŒ Ø§ÙØªØ±Ø¶Øª Ø£Ù†Ù‡ mp3)
        'call_end': './sounds/callEndSound.mp3', 
        
        // Ø£ØµÙˆØ§Øª Ø¥Ø¶Ø§ÙÙŠØ© Ø§ÙØªØ±Ø§Ø¶ÙŠØ© (Ù„Ùˆ Ù…Ø´ Ø¹Ù†Ø¯Ùƒ Ù…Ù„ÙØ§Øª Ù„ÙŠÙ‡Ù…ØŒ Ù…Ù…ÙƒÙ† ØªÙƒØ±Ø± Ù…Ù„ÙØ§Øª ØªØ§Ù†ÙŠØ© Ù…Ø¤Ù‚ØªØ§Ù‹)
        'sent':     './sounds/incoming.mp3', // ØµÙˆØª Ø¹Ù†Ø¯ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ (Ù…Ø¤Ù‚Øª)
        'like':     './sounds/incoming.mp3', // ØµÙˆØª Ø§Ù„Ù„Ø§ÙŠÙƒ (Ù…Ø¤Ù‚Øª)
        'click':    './sounds/incoming.mp3'  // ØµÙˆØª Ø§Ù„Ø¶ØºØ· (Ù…Ø¤Ù‚Øª)
    };

    // Ù…Ø®Ø²Ù† Ù„Ù„Ø£ØµÙˆØ§Øª Ø§Ù„Ù…Ø­Ù…Ù„Ø© (Ø¹Ø´Ø§Ù† Ø§Ù„Ø³Ø±Ø¹Ø© ÙˆØ¹Ø¯Ù… Ø§Ù„ØªØ­Ù…ÙŠÙ„ ÙƒÙ„ Ù…Ø±Ø©)
    const audioCache = {};

    // 2. ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£ØµÙˆØ§Øª ÙÙŠ Ø§Ù„Ø°Ø§ÙƒØ±Ø© Ø£ÙˆÙ„ Ù…Ø§ Ø§Ù„Ù…ÙˆÙ‚Ø¹ ÙŠÙØªØ­ (Preload)
    function preloadSounds() {
        for (const [key, path] of Object.entries(soundMap)) {
            const audio = new Audio(path);
            audio.preload = 'auto'; // Ø£Ù…Ø± Ù„Ù„Ù…ØªØµÙØ­ ÙŠØ¬Ù‡Ø² Ø§Ù„Ù…Ù„Ù
            audioCache[key] = audio;
        }
        console.log("âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ Ù…ÙƒØªØ¨Ø© Ø§Ù„Ø£ØµÙˆØ§Øª Ù…Ù† Ø§Ù„Ù…Ø¬Ù„Ø¯ Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ");
    }

    // 3. Ø¯Ø§Ù„Ø© Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠØ© (Ø§Ù„Ù„ÙŠ Ù‡Ù†Ù†Ø§Ø¯ÙŠ Ø¹Ù„ÙŠÙ‡Ø§ ÙÙŠ Ø£ÙŠ Ù…ÙƒØ§Ù†)
    window.playSound = function(type) {
        const sound = audioCache[type];

        if (sound) {
            sound.currentTime = 0; // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØµÙˆØª Ù„Ù„Ø¨Ø¯Ø§ÙŠØ© (Ù„Ùˆ Ø¶ØºØ·Øª Ø¨Ø³Ø±Ø¹Ø©)
            
            // Ø¶Ø¨Ø· Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØµÙˆØª (Ø§Ù„Ø±Ù†Ø§Øª ØªÙƒÙˆÙ† Ø¹Ø§Ù„ÙŠØ©ØŒ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ù…ØªÙˆØ³Ø·Ø©)
            if(type === 'ring_in' || type === 'ring_out') {
                sound.volume = 1.0; 
            } else {
                sound.volume = 0.6;
            }
            
            // Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„ØªØ´ØºÙŠÙ„
            sound.play().catch(error => {
                console.warn("Autoplay blocked:", error);
            });
        } else {
            console.warn(`Sound type "${type}" not found!`);
        }
    };
    
    // Ø¯Ø§Ù„Ø© Ù„Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ØµÙˆØª (Ù…Ù‡Ù…Ø© Ù„Ù„Ù…ÙƒØ§Ù„Ù…Ø§Øª)
    window.stopSound = function(type) {
        const sound = audioCache[type];
        if (sound) {
            sound.pause();
            sound.currentTime = 0;
        }
    };

    // ØªØ´ØºÙŠÙ„ Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø³Ø¨Ù‚ ÙÙˆØ±Ø§Ù‹
    preloadSounds();

})();
