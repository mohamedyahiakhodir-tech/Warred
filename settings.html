<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NABD - Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">

<style>
/* ================= CSS Styles (Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ) ================= */
*{margin:0;padding:0;box-sizing:border-box;font-family:'Segoe UI',Tahoma,Verdana,sans-serif;transition:all .2s ease-in-out}
body{background:#0d0d0f;color:#fff}
a{text-decoration:none;color:inherit}

/* HEADER */
.header{
    display:flex;justify-content:flex-start;align-items:center;
    padding:18px 15px;font-size:20px;font-weight:900;
    border-bottom:1px solid #1f1f23;position:sticky;top:0;
    background:#0d0d0f;z-index:50;
}
.header-btn{cursor:pointer;font-size:22px;color:#7c3aed; margin-left: 15px;}
.header-name{font-size:20px;font-weight:700;}

/* SETTINGS CONTAINER */
.settings-container{
    max-width: 600px;
    margin: 20px auto;
    padding: 0 15px;
}
.setting-section h2{
    color: #7c3aed;
    font-size: 18px;
    padding: 10px 0;
    margin-top: 25px;
    border-bottom: 2px solid #1f1f23;
}

/* SETTING ITEM */
.setting-item{
    display:flex;justify-content:space-between;align-items:center;
    padding:15px 0;
    border-bottom:1px solid #1f1f23;
    cursor:pointer;
}
.setting-item:last-child{
    border-bottom:none;
}
.setting-info{
    display:flex;align-items:center;gap:15px;
}
.setting-info i{
    font-size: 20px;
    width: 30px;
    text-align: center;
    color: #7c3aed;
}
.setting-label{
    font-size: 16px;
}
.setting-action{
    font-size: 14px;
    opacity: 0.7;
}

/* Theme Toggle Switch */
.switch {
    position: relative;
    display: inline-block;
    width: 50px;
    height: 28px;
}
.switch input {opacity: 0; width: 0; height: 0;}
.slider {
    position: absolute;
    cursor: pointer;
    top: 0; left: 0; right: 0; bottom: 0;
    background-color: #ccc;
    transition: .4s;
    border-radius: 28px;
}
.slider:before {
    position: absolute;
    content: "";
    height: 20px;
    width: 20px;
    left: 4px;
    bottom: 4px;
    background-color: white;
    transition: .4s;
    border-radius: 50%;
}
input:checked + .slider {
    background-color: #7c3aed;
}
input:checked + .slider:before {
    transform: translateX(20px);
}

/* Specific Styles */
.danger-zone .setting-info i, .danger-zone .setting-label {
    color: #ff5555;
}

/* ================= LIGHT MODE STYLES (ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ©) ================= */
body.light-mode {
    background: #f0f2f5; 
    color: #1a1a1a;     
}
body.light-mode .header {
    background: #fff;
    border-bottom-color: #e0e0e0;
}
body.light-mode .setting-section h2 {
    border-bottom-color: #e0e0e0;
}
body.light-mode .setting-item {
    border-bottom-color: #e0e0e0;
}
body.light-mode .setting-info i {
    color: #3f51b5; 
}
</style>
</head>

<body class="dark-mode"> 

<div id="reauthModal" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.8); z-index:100; align-items:center; justify-content:center; flex-direction:column; padding:20px;">
    <div style="background:#1c1c1c; padding:30px; border-radius:10px; max-width:350px; width:100%;">
        <h3 style="color:#ff5555; margin-bottom:15px; text-align:center;">ØªØ£ÙƒÙŠØ¯ Ø­Ø°Ù Ø§Ù„Ø­Ø³Ø§Ø¨</h3>
        <p style="margin-bottom:15px;">Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ù„Ù„Ù…ØªØ§Ø¨Ø¹Ø©:</p>
        <input type="password" id="reauthPassword" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø­Ø§Ù„ÙŠØ©" style="width:100%; padding:10px; margin-bottom:15px; background:#0d0d0f; border:1px solid #333; border-radius:8px; color:#fff;">
        
        <div style="display:flex; justify-content:space-between;">
            <button onclick="document.getElementById('reauthModal').style.display='none'" style="background:#333; color:#ccc; padding:10px; border:none; border-radius:8px; flex:1; margin-left:10px;">Ø¥Ù„ØºØ§Ø¡</button>
            <button onclick="reauthenticateAndDelete()" style="background:#ff5555; color:#fff; padding:10px; border:none; border-radius:8px; flex:1;">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø°Ù</button>
        </div>
        <p id="reauthError" style="color:red; margin-top:10px; font-size:12px; display:none; text-align:center;"></p>
    </div>
</div>
<div class="header">
  <i class="fa-solid fa-arrow-right header-btn" onclick="goBack()"></i>
  <span class="header-name">Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</span>
</div>

<div class="settings-container">
    
    <div class="setting-section">
        <h2><i class="fa-solid fa-paintbrush"></i> Ø§Ù„Ù…Ø¸Ù‡Ø±</h2>
        
        <div class="setting-item" style="cursor: default;">
            <div class="setting-info">
                <i class="fa-solid fa-moon"></i>
                <span class="setting-label">Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ / Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„ÙØ§ØªØ­</span>
            </div>
            <label class="switch">
                <input type="checkbox" id="themeToggle" onchange="toggleTheme()">
                <span class="slider"></span>
            </label>
        </div>
    </div>

    <div class="setting-section">
        <h2><i class="fa-solid fa-user-gear"></i> Ø§Ù„Ø­Ø³Ø§Ø¨ ÙˆØ§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ</h2>
        
        <div class="setting-item" onclick="location.href=getFilePath('edit.html')">
            <div class="setting-info">
                <i class="fa-solid fa-pen-to-square"></i>
                <span class="setting-label">ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ</span>
            </div>
            <div class="setting-action"><i class="fa-solid fa-chevron-left"></i></div>
        </div>
    </div>
    
    <div class="setting-section">
        <h2><i class="fa-solid fa-shield-halved"></i> Ø§Ù„Ø®ØµÙˆØµÙŠØ© ÙˆØ§Ù„Ø£Ù…Ø§Ù†</h2>
        
        <div class="setting-item" onclick="location.href=getFilePath('security.html')">
            <div class="setting-info">
                <i class="fa-solid fa-lock"></i>
                <span class="setting-label">ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ÙˆØ¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø£Ù…Ø§Ù†</span>
            </div>
            <div class="setting-action"><i class="fa-solid fa-chevron-left"></i></div>
        </div>
    </div>
    
    <div class="setting-section danger-zone">
        <h2><i class="fa-solid fa-fire-extinguisher"></i> Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø£Ø®Ø±Ù‰</h2>

        <div class="setting-item" onclick="logout()">
            <div class="setting-info">
                <i class="fa-solid fa-right-from-bracket"></i>
                <span class="setting-label">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</span>
            </div>
            <div class="setting-action"><i class="fa-solid fa-chevron-left"></i></div>
        </div>
        
        <div class="setting-item" onclick="confirmDeleteAccount()">
            <div class="setting-info">
                <i class="fa-solid fa-trash-can"></i>
                <span class="setting-label">Ø­Ø°Ù Ø§Ù„Ø­Ø³Ø§Ø¨ Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹</span>
            </div>
            <div class="setting-action"><i class="fa-solid fa-chevron-left"></i></div>
        </div>
    </div>

</div>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script>
// ğŸš¨ Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ Ù„Ù…Ù„ÙØ§Øª NABD ğŸš¨
const BASE_PATH = 'file:///storage/emulated/0/NABD/';

function getFilePath(fileName) {
    return BASE_PATH + fileName;
}


// Ø¥Ø¹Ø¯Ø§Ø¯ Firebase 
firebase.initializeApp({
  apiKey:"AIzaSyDpvqNAReChsHn5tFJSp7vV_EJHmtD2x4c", 
  authDomain:"pools-e4381.firebaseapp.com",
  projectId:"pools-e4381"
});

const auth = firebase.auth();
const themeToggleEl = document.getElementById('themeToggle');
const reauthPasswordEl = document.getElementById('reauthPassword');
const reauthErrorEl = document.getElementById('reauthError');

// Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø§Ù„Ø© Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© (Ù„Ø¶Ù…Ø§Ù† Ø¨Ù‚Ø§Ø¡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ settings.html Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…Ø³Ø¬Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„)
auth.onAuthStateChanged(user => {
    if (!user) {
        // Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù…Ø³Ø¬Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„ØŒ ÙˆØ¬Ù‡Ù‡ Ø¥Ù„Ù‰ ØµÙØ­Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„ (index.html)
        location.href = getFilePath("index.html"); 
    } 
});


/* 1. ÙˆØ¸Ø§Ø¦Ù Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„Ù…Ø¸Ù‡Ø± (Theme Toggle) */
function loadTheme() {
    const savedTheme = localStorage.getItem('theme') || 'dark';
    
    if (savedTheme === 'light') {
        document.body.classList.add('light-mode');
        themeToggleEl.checked = true;
    } else {
        document.body.classList.remove('light-mode');
        themeToggleEl.checked = false;
    }
}

function toggleTheme() {
    if (themeToggleEl.checked) {
        document.body.classList.add('light-mode');
        localStorage.setItem('theme', 'light');
    } else {
        document.body.classList.remove('light-mode');
        localStorage.setItem('theme', 'dark');
    }
}

// ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø¸Ù‡Ø± Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„ØµÙØ­Ø©
window.onload = loadTheme;


/* 2. Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© */
function goBack() {
  // ğŸš¨ ØªÙ… Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ù‡Ù†Ø§ Ù„ÙŠØ¹ÙˆØ¯ Ø¥Ù„Ù‰ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© (home.html) ğŸš¨
  location.href = getFilePath("home.html"); 
}

function logout() {
    auth.signOut().then(() => {
        // ğŸš¨ ØªÙ… Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ù‡Ù†Ø§ Ù„ÙŠØ¹ÙˆØ¯ Ø¥Ù„Ù‰ ØµÙØ­Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ (index.html) ğŸš¨
        location.href = getFilePath("index.html"); 
    }).catch(error => {
        alert("Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬: " + error.message);
    });
}


/* 3. ÙˆØ¸Ø§Ø¦Ù Ø­Ø°Ù Ø§Ù„Ø­Ø³Ø§Ø¨ (Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© + Ø§Ù„Ø­Ø°Ù) */

function confirmDeleteAccount() {
    // Ø¹Ø±Ø¶ Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…ÙˆØ¯Ø§Ù„ Ù„Ø·Ù„Ø¨ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
    document.getElementById('reauthModal').style.display='flex';
    reauthPasswordEl.value = '';
    reauthErrorEl.style.display = 'none';
}

function reauthenticateAndDelete() {
    const password = reauthPasswordEl.value;
    const user = auth.currentUser;
    
    if (!user) {
        reauthErrorEl.innerText = "Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø³Ø¬Ù„ Ø­Ø§Ù„ÙŠØ§Ù‹.";
        reauthErrorEl.style.display = 'block';
        return;
    }
    
    if (!password) {
        reauthErrorEl.innerText = "Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±.";
        reauthErrorEl.style.display = 'block';
        return;
    }

    const credentials = firebase.auth.EmailAuthProvider.credential(
        user.email, 
        password
    );

    // 1. Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© Ù„Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ Ù‡Ùˆ Ø§Ù„Ù…Ø§Ù„Ùƒ
    user.reauthenticateWithCredential(credentials)
        .then(() => {
            // 2. Ù†Ø¬Ø­Øª Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©ØŒ Ø§Ù„Ø¢Ù† ÙŠÙ…ÙƒÙ† Ø­Ø°Ù Ø§Ù„Ø­Ø³Ø§Ø¨
            user.delete()
                .then(() => {
                    alert("ØªÙ… Ø­Ø°Ù Ø­Ø³Ø§Ø¨Ùƒ Ø¨Ù†Ø¬Ø§Ø­. Ù†Ø¹ØªØ°Ø± Ù„Ø±Ø¤ÙŠØªÙƒ ØªØ±Ø­Ù„.");
                    document.getElementById('reauthModal').style.display='none';
                    // 3. Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ø¥Ù„Ù‰ ØµÙØ­Ø© Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø¨Ø¹Ø¯ Ø§Ù„Ø­Ø°Ù Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ù…Ø·Ù„Ù‚
                    location.href = getFilePath("index.html"); 
                })
                .catch(error => {
                    // ÙØ´Ù„ Ø§Ù„Ø­Ø°Ù
                    reauthErrorEl.innerText = "ÙØ´Ù„ Ø­Ø°Ù Ø§Ù„Ø­Ø³Ø§Ø¨: " + error.message;
                    reauthErrorEl.style.display = 'block';
                });
        })
        .catch(error => {
            // ÙØ´Ù„ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© (ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©)
            reauthErrorEl.innerText = "ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø© Ø£Ùˆ Ø­Ø³Ø§Ø¨Ùƒ Ù‚Ø¯ÙŠÙ… Ø¬Ø¯Ø§Ù‹ ÙˆÙŠØªØ·Ù„Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø¬Ø¯ÙŠØ¯.";
            reauthErrorEl.style.display = 'block';
        });
}
</script>

</body>
</html>
