<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NABD - إنشاء حساب</title>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* --- التنسيقات العامة --- */
        *{margin:0;padding:0;box-sizing:border-box}
        html,body{
            width:100%;height:100%;
            background:#0d0d0f; 
            font-family:'Segoe UI', Tahoma, Verdana, sans-serif;
            overflow-x:hidden; color:#fff;
            display: flex; justify-content: center; align-items: center;
        }
        canvas{position:fixed;inset:0;z-index:0}

        /* --- صندوق إنشاء الحساب --- */
        .box{
            position:relative;z-index:2;
            width:95%; max-width:420px;
            padding:30px; margin: 20px auto;
            background:rgba(22, 22, 26, 0.85); 
            backdrop-filter:blur(15px);
            -webkit-backdrop-filter: blur(15px);
            border-radius:24px; border:1px solid rgba(255,255,255,0.1); 
            box-shadow:0 20px 50px rgba(0,0,0,0.8);
        }
        .box h2{ text-align:center; margin-bottom:25px; color:#7c3aed; font-size: 28px; font-weight: 800; }
        
        /* --- تنسيق الحقول --- */
        .input-group { margin-bottom: 15px; text-align: right; }
        .input-group label { display: block; margin-bottom: 6px; font-size: 13px; color: #aaa; margin-right: 5px; }
        .box input {
            width:100%; padding:13px; 
            background:#1a1a1d; border:1px solid #333; 
            border-radius:12px; color:#fff; font-size: 14px;
            transition: 0.3s ease-in-out;
        }
        .box input:focus { border-color: #7c3aed; outline: none; background:#222; box-shadow: 0 0 8px rgba(124, 58, 237, 0.2); }

        /* --- الأزرار --- */
        .btn-reg {
            width:100%; padding:14px; 
            background: linear-gradient(135deg, #7c3aed, #5b21b6); 
            border:none; border-radius:12px; color:#fff;
            font-size: 16px; font-weight: bold; cursor: pointer;
            margin-top: 10px; transition: 0.3s;
            box-shadow: 0 6px 20px rgba(124, 58, 237, 0.3);
        }
        .btn-reg:hover { transform: translateY(-2px); opacity: 0.9; }
        .btn-reg:active { transform: scale(0.98); }

        /* الفاصل */
        .divider {
            margin: 20px 0; display: flex; align-items: center; text-align: center; color: #555;
        }
        .divider::before, .divider::after { content: ''; flex: 1; border-bottom: 1px solid #333; }
        .divider span { padding: 0 10px; font-size: 12px; }

        /* زر جوجل المصلح */
        .google-btn {
            width:100%; padding:12px; 
            background:#fff; border:none; 
            border-radius:12px; color:#000;
            font-size: 15px; font-weight: bold; cursor: pointer;
            display: flex; align-items: center; justify-content: center; 
            gap: 12px; transition: 0.3s;
        }
        .google-btn:hover { background: #f1f1f1; transform: translateY(-2px); }
        .google-btn img { width: 22px; height: 22px; display: block; }

        /* التذييل */
        .login-footer { margin-top: 25px; text-align: center; font-size: 14px; color: #aaa; }
        .login-footer a { color: #7c3aed; text-decoration: none; font-weight: bold; transition: 0.3s; }
        .login-footer a:hover { color: #fff; text-shadow: 0 0 5px #7c3aed; }
    </style>
</head>
<body>

<canvas id="bg"></canvas>

<div class="box">
  <h2>إنشاء حساب NABD</h2>
  
  <div class="input-group">
    <label><i class="fa-solid fa-user"></i> الاسم الكامل</label>
    <input id="reg-name" type="text" placeholder="أدخل اسمك الثلاثي">
  </div>

  <div class="input-group">
    <label><i class="fa-solid fa-envelope"></i> البريد الإلكتروني</label>
    <input id="reg-email" type="email" placeholder="example@mail.com">
  </div>

  <div class="input-group">
    <label><i class="fa-solid fa-calendar-days"></i> تاريخ الميلاد</label>
    <input id="reg-birth" type="date">
  </div>

  <div class="input-group">
    <label><i class="fa-solid fa-lock"></i> كلمة المرور</label>
    <input id="reg-pass" type="password" placeholder="********">
  </div>

  <button class="btn-reg" onclick="registerWithEmail()">إنشاء الحساب</button>

  <div class="divider"><span>أو سجل عبر</span></div>

  <button class="google-btn" onclick="signInWithGoogle()">
    <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" alt="Google">
    <span>التسجيل بواسطة جوجل</span>
  </button>

  <div class="login-footer">
    لديك حساب بالفعل؟ <a href="index.html">تسجيل الدخول</a>
  </div>
</div>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
// إعدادات Firebase
firebase.initializeApp({
  apiKey: "AIzaSyDpvqNAReChsHn5tFJSp7vV_EJHmtD2x4c",
  authDomain: "pools-e4381.firebaseapp.com",
  projectId: "pools-e4381",
  messagingSenderId: "339799216046",
  appId: "1:339799216046:web:26e437a7b7d5c24fe9023f"
});

const auth = firebase.auth();
const db = firebase.firestore();

// دالة التسجيل
function registerWithEmail() {
    const name = document.getElementById("reg-name").value;
    const email = document.getElementById("reg-email").value;
    const birth = document.getElementById("reg-birth").value;
    const pass = document.getElementById("reg-pass").value;

    if(!name || !email || !birth || !pass) {
        Swal.fire({title:'تنبيه', text:'يرجى ملء كافة البيانات', icon:'warning', background:'#16161a', color:'#fff'});
        return;
    }

    auth.createUserWithEmailAndPassword(email, pass)
    .then((userCredential) => {
        return db.collection("users").doc(userCredential.user.uid).set({
            fullName: name,
            email: email,
            birthday: birth,
            createdAt: new Date()
        }).then(() => userCredential);
    })
    .then((userCredential) => {
        Swal.fire({
            title: 'مبروك!',
            text: 'تم إنشاء حسابك بنجاح في نبض',
            icon: 'success',
            background: '#16161a',
            color: '#fff',
            confirmButtonColor: '#7c3aed'
        }).then(() => {
            window.location.replace('home.html');
        });
    })
    .catch(err => Swal.fire({title:'خطأ', text:err.message, icon:'error', background:'#16161a', color:'#fff'}));
}

// دالة جوجل
function signInWithGoogle() {
    const provider = new firebase.auth.GoogleAuthProvider();
    auth.signInWithPopup(provider).then((result) => {
        window.location.replace('home.html');
    }).catch(err => Swal.fire({title:'خطأ', text:err.message, icon:'error', background:'#16161a', color:'#fff'}));
}

// كود الخلفية المتحركة
const c=bg,x=c.getContext("2d");
function r(){c.width=innerWidth;c.height=innerHeight}
r(); addEventListener("resize",r);
let s=[],R=(a,b)=>Math.random()*(b-a)+a;
for(let i=0;i<120;i++) s.push({x:R(0,c.width),y:R(0,c.height),a:R(0,6.28),v:R(.1,.3),l:R(6,16),o:R(.2,.6)});
(function d(){
  x.clearRect(0,0,c.width,c.height);
  s.forEach(e=>{
    x.save();x.translate(e.x,e.y);x.rotate(e.a);
    x.strokeStyle=`rgba(124, 58, 237,${e.o})`; 
    x.beginPath();x.moveTo(0,0);x.lineTo(e.l,R(-3,3));x.stroke();x.restore();
    e.x+=Math.cos(e.a)*e.v; e.y+=Math.sin(e.a)*e.v;
    if(e.x<0||e.y<0||e.x>c.width||e.y>c.height){e.x=R(0,c.width);e.y=R(0,c.height);}
  });
  requestAnimationFrame(d);
})();
</script>
</body>
</html>
